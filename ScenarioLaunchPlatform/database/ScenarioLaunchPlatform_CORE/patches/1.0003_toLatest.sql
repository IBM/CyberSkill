-- 1.0004 changes --
ALTER TABLE tb_query
ADD COLUMN video_link character varying(500);
UPDATE public.tb_version SET version = 'v01.0004';

-- 1.0005 changes --
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (101, 35, 'Exceptions', 'UPDATE+employees+SET+salary+%3D+salary+%2B+100+WHERE+emp_id+%3D+1%3B%0Aselect+*+from+DB2INST1.EMP+WHERE+1%3D1%3B%0ASELECT+*+FROM+NON_EXISTING_TABLE%3B%0Aselect+*+from+CREDITCARDS%3B%0ASelect+*+from+CCN%3B%0ASELECT+*+FROM+HR.SALARIES+WHERE+security_label+%3D+%27TOP_SECRET%27%3B%0ADROP+TABLE+CUSTOMERS%3B', 'Exceptions issues DB2', 'db2', 'Updates, Selects and DROP in DB2 fro Exceptions', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (102, 35, 'Exceptions', '--+Create+a+New+Schema%0ACREATE+SCHEMA+CLONE+AUTHORIZATION+db2inst1%3B%0A%0A--+Clone+the+CQWCOL.CUSTOMER+Table+into+the+New+Schema%0ACREATE+TABLE+CLONE.CUSTOMER+AS+%28SELECT+*+FROM+CQWCOL.CUSTOMER%29+WITH+NO+DATA%3B%0A%0A--+Insert+Data+in+Batches+of+100+Rows+%281st+Batch%29%0AINSERT+INTO+CLONE.CUSTOMER+%0ASELECT+*+FROM+CQWCOL.CUSTOMER%0AFETCH+FIRST+100+ROWS+ONLY%3B%0A%0A--+Insert+Data+in+Batches+of+100+Rows+%282nd+Batch%29%0AINSERT+INTO+CLONE.CUSTOMER%0ASELECT+*%0AFROM+CQWCOL.CUSTOMER%0AOFFSET+100+ROWS+FETCH+NEXT+100+ROWS+ONLY%3B%0A%0A--+Insert+Data+in+Batches+of+100+Rows+%283rd+Batch%29%0AINSERT+INTO+CLONE.CUSTOMER%0ASELECT+*%0AFROM+CQWCOL.CUSTOMER%0AOFFSET+200+ROWS+FETCH+NEXT+100+ROWS+ONLY%3B%0A%0A--+Insert+Data+in+Batches+of+100+Rows+%284th+Batch%29%0AINSERT+INTO+CLONE.CUSTOMER%0ASELECT+*%0AFROM+CQWCOL.CUSTOMER%0AOFFSET+300+ROWS+FETCH+NEXT+100+ROWS+ONLY%3B%0A%0A--+Select+Data+%0ASELECT+*+FROM+CLONE.CUSTOMER%3B%0ASELECT+*+FROM+CQWCOL.CUSTOMER%3B%0A%0A--+Grant+All+Privileges+to+User+on+the+Cloned+Table%0AGRANT+ALL+PRIVILEGES+ON+TABLE+CLONE.CUSTOMER+TO+USER+polly%3B%0AGRANT+ALL+PRIVILEGES+ON+TABLE+CLONE.CUSTOMER+TO+USER+liher%3B%0AGRANT+ALL+PRIVILEGES+ON+TABLE+CLONE.CUSTOMER+TO+USER+jason%3B%0AGRANT+ALL+PRIVILEGES+ON+TABLE+CLONE.CUSTOMER+TO+USER+john%3B%0AGRANT+ALL+PRIVILEGES+ON+TABLE+CLONE.CUSTOMER+TO+USER+ian%3B%0A%0A--+Grant+Data+Access+Privileges+to+User+%0AGRANT+SELECT%2C+INSERT%2C+UPDATE%2C+DELETE+ON+TABLE+CLONE.CUSTOMER+TO+USER+polly%3B%0AGRANT+SELECT%2C+INSERT%2C+UPDATE%2C+DELETE+ON+TABLE+CLONE.CUSTOMER+TO+USER+liher%3B%0AGRANT+SELECT%2C+INSERT%2C+UPDATE%2C+DELETE+ON+TABLE+CLONE.CUSTOMER+TO+USER+jason%3B%0AGRANT+SELECT%2C+INSERT%2C+UPDATE%2C+DELETE+ON+TABLE+CLONE.CUSTOMER+TO+USER+john%3B%0AGRANT+SELECT%2C+INSERT%2C+UPDATE%2C+DELETE+ON+TABLE+CLONE.CUSTOMER+TO+USER+ian%3B%0A%0A--+Drop+the+Cloned+Table%0ADROP+TABLE+CLONE.CUSTOMER%3B%0A%0A--+Drop+the+New+Schema%0ADROP+SCHEMA+CLONE+RESTRICT%3B', 'Clone Data in DB2', 'db2', 'Clone data in newly create schema DB2', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (109, 35, 'Drop', '--+Drop+the+Cloned+Table%0ADROP+TABLE+HR.EMPLOYEES%3B', 'Drop HR.Employees', 'db2', 'This will drop HR.Employees', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (110, 35, 'Drop', '--+Drop+the+HR+Schema%0ADROP+SCHEMA+HR+RESTRICT%3B%0A', 'Drop HR Schema', 'db2', 'This will drop HR Schema', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (103, 35, 'Exceptions', '--+Create+a+New+Schema%0ACREATE+SCHEMA+HR+AUTHORIZATION+db2inst1%3B%0A%0A--+Clone+the+Existing+Employees+Table+into+the+New+Schema%0ACREATE+TABLE+HR.EMPLOYEES+AS+%28SELECT+*+FROM+db2inst1.EMP%29+WITH+DATA%3B%0A%0A--+Alter+the+Cloned+Table%3A+Add+a+New+Column%0AALTER+TABLE+HR.EMPLOYEES+ADD+COLUMN+DEPARTMENT+VARCHAR%2850%29+DEFAULT+%27General%27%3B%0A%0ASELECT+*+FROM+HR.EMPLOYEES+WHERE+EMPNO+%3D+%27000010%27%3B%0A%0A--+Update+a+Record+in+the+Cloned+Table%0AUPDATE+HR.EMPLOYEES+SET+SALARY+%3D+190000++WHERE+EMPNO+%3D+%27000010%27%3B%0A%0ASELECT+*+FROM+HR.EMPLOYEES+WHERE+EMPNO+%3D+%27000010%27%3B%0A%0A--+Delete+a+Record+from+the+Cloned+Table%0ADELETE+FROM+HR.EMPLOYEES+WHERE+EMPNO+%3D+%27000010%27%3B%0A%0A--+Drop+the+Cloned+Table%0ADROP+TABLE+HR.EMPLOYEES%3B%0A%0A--+Drop+the+New+Schema%0ADROP+SCHEMA+HR+RESTRICT%3B%0A', 'Create and Drop schema with actions performed', 'db2', 'Create new schema in DB2 perform some actions then drop', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (104, 35, 'Update', '--+Create+a+New+Schema%0ACREATE+SCHEMA+HR+AUTHORIZATION+db2inst1%3B%0A', 'Create schema HR Authorization', 'db2', 'This will create a new schema', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (105, 35, 'Update', '--+Clone+the+Existing+Employees+Table+into+the+New+Schema%0ACREATE+TABLE+HR.EMPLOYEES+AS+%28SELECT+*+FROM+db2inst1.EMP%29+WITH+DATA%3B%0A%0A--+Alter+the+Cloned+Table%3A+Add+a+New+Column%0AALTER+TABLE+HR.EMPLOYEES+ADD+COLUMN+DEPARTMENT+VARCHAR%2850%29+DEFAULT+%27General%27%3B%0A%0A', 'Create an HR.Employees table', 'db2', 'This will create a HR,Employees table from an existing table db2inst1.EMP', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (106, 35, 'Select', 'SELECT+*+FROM+HR.EMPLOYEES+WHERE+EMPNO+%3D+%27000010%27%3B', 'Select from HR.Employees', 'db2', 'This will select a row from HR.Employees', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (107, 35, 'Update', '--+Update+a+Record+in+the+Cloned+Table%0AUPDATE+HR.EMPLOYEES+SET+SALARY+%3D+190000++WHERE+EMPNO+%3D+%27000010%27%3B', 'Update HR.Employees', 'db2', 'This will update a row in HR.Employees', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (108, 35, 'Delete', '--+Delete+a+Record+from+the+Cloned+Table%0ADELETE+FROM+HR.EMPLOYEES+WHERE+EMPNO+%3D+%27000010%27%3B', 'Delete HR.Employees', 'db2', 'This will delete a row in HR.Employees', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (100, 35, 'Policy Violation', 'REVOKE+DBADM+ON+DATABASE+FROM+USER+liher%3B%0AREVOKE+DBADM+ON+DATABASE+FROM+USER+jason%3B%0AREVOKE+DBADM+ON+DATABASE+FROM+USER+john%3B%0AREVOKE+DBADM+ON+DATABASE+FROM+USER+ian%3B', 'Revoke Permissions', 'db2', 'Revoke and Grant users access on DB2', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (111, 35, 'Update', '--+Grant+Database-Level+Privileges%0AGRANT+DBADM+ON+DATABASE+TO+USER+polly%3B%0AGRANT+DBADM+ON+DATABASE+TO+USER+liher%3B%0AGRANT+DBADM+ON+DATABASE+TO+USER+jason%3B%0AGRANT+DBADM+ON+DATABASE+TO+USER+john%3B%0AGRANT+DBADM+ON+DATABASE+TO+USER+ian%3B', 'Grant Permissions', 'db2', '', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (112, 35, 'Update', '--+Grant+Role-Based+Superuser+Access+%28Optional%2C+for+Full+Admin+Rights%29%0AGRANT+SECADM%2C+DBADM%2C+DATAACCESS%2C+ACCESSCTRL+ON+DATABASE+TO+USER+polly%3B%0AGRANT+SECADM%2C+DBADM%2C+DATAACCESS%2C+ACCESSCTRL+ON+DATABASE+TO+USER+liher%3B%0AGRANT+SECADM%2C+DBADM%2C+DATAACCESS%2C+ACCESSCTRL+ON+DATABASE+TO+USER+jason%3B%0AGRANT+SECADM%2C+DBADM%2C+DATAACCESS%2C+ACCESSCTRL+ON+DATABASE+TO+USER+john%3B%0AGRANT+SECADM%2C+DBADM%2C+DATAACCESS%2C+ACCESSCTRL+ON+DATABASE+TO+USER+ian%3B%0A', 'Grant SuperUser Permissions', 'db2', '', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (113, 35, 'Update', 'CREATE+TABLE+CUSTOMER_CREDITCARDS+%28CUSTOMER_ID+INTEGER+NOT+NULL+%2CNAME+VARCHAR%28100%29+NOT+NULL%2C+EMAIL+VARCHAR%28100%29+UNIQUE+NOT+NULL%2C+PHONE+VARCHAR%2820%29%2C+CREDIT_CARD_NUMBER+CHAR%2816%29+NOT+NULL%2C+EXPIRY_DATE+DATE+NOT+NULL%29%3B', 'Create customer_creditcards table', 'db2', '', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (114, 35, 'Update', 'ALTER+TABLE+CUSTOMER_CREDITCARDS+ADD+COLUMN+CVV+SMALLINT+CHECK+%28CVV+BETWEEN+100+AND+999%29%3B', 'Alter customer_creditcards table', 'db2', '', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (115, 35, 'Insert', 'INSERT+INTO+CUSTOMER_CREDITCARDS+%28CUSTOMER_ID%2C+NAME%2C+EMAIL%2C+PHONE%2C+CREDIT_CARD_NUMBER%2C+EXPIRY_DATE%2C+CVV%29+VALUES+%281%2C+%27Alice+Johnson%27%2C+%27alice%40gdemo.com%27%2C+%27555-1234%27%2C+%274111111111111111%27%2C+%272026-06-30%27%2C+123%29%2C+%282%2C+%27Bob+Smith%27%2C+%27bob%40gdemo.com%27%2C+%27555-5678%27%2C+%275500000000000004%27%2C+%272027-09-15%27%2C+456%29%2C+%283%2C+%27Charlie+Brown%27%2C+%27charlie%40gdemo.com%27%2C+%27555-9876%27%2C+%27340000000000009%27%2C+%272028-12-10%27%2C+789%29%3B', 'Insert into customer_creditcards table', 'db2', '', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (116, 35, 'Select', 'SELECT+*+FROM+CUSTOMER_CREDITCARDS%3B', 'Select from customer_creditcards table', 'db2', '', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (117, 35, 'Delete', 'DELETE+FROM+CUSTOMER_CREDITCARDS+WHERE+CUSTOMER_ID+%3D+2%3B', 'Delete from customer_creditcards table', 'db2', '', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (118, 35, 'Drop', 'DROP+TABLE+CUSTOMER_CREDITCARDS%3B', 'Drop customer_creditcards table', 'db2', '', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (120, 35, 'Outlier', 'select+*+from+DB2INST1.EMP+WHERE+1%3D1%3B', 'basic SQL injection', 'db2', '', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (121, 35, 'Exceptions', 'SELECT+*+FROM+HR.SALARIES+WHERE+security_label+%3D+%27TOP_SECRET%27%3B', 'Bad where clause', 'db2', '', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (122, 35, 'Exceptions', 'DROP+TABLE+CUSTOMERS%3B', 'Bad drop clause', 'db2', '', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (119, 35, 'Exceptions', 'UPDATE+employees+SET+salary+%3D+salary+%2B+100+WHERE+emp_id+%3D+1%3B', 'Update non existent table', 'db2', '', '', 1);

INSERT INTO public.tb_stories (id, runtime, story) VALUES (4, NULL, '{"name": "DB2 Monitoring Sys Privilege Management", "story": [{"query_id": 100, "datasource": "db2_localhost_SAMPLE_polly", "pause_in_seconds": 4000}, {"query_id": 111, "datasource": "db2_localhost_SAMPLE_polly", "pause_in_seconds": 4000}, {"query_id": 112, "datasource": "db2_localhost_SAMPLE_polly", "pause_in_seconds": 4000}], "video": "https://ibm.github.io/CyberSkill/?video=revokeAndGrantPermissions.mp4", "author": "polly", "handbook": "/handbooks/monitoringSysAdmin.pdf", "outcomes": "Understand how Guardium monitors privilege management", "description": "This simple story involves revoking and adding privilege. This story runs in the following flow. 1. Polly revokes user permissions. Sometime later (4 seconds)2. Polly grants permissions. Sometime later (4 seconds) 3. Polly grants greater permissions"}');
INSERT INTO public.tb_stories (id, runtime, story) VALUES (5, NULL, '{"name": "DB2 Monitoring table management", "story": [{"query_id": 113, "datasource": "db2_localhost_SAMPLE_polly", "pause_in_seconds": 4000}, {"query_id": 114, "datasource": "db2_localhost_SAMPLE_polly", "pause_in_seconds": 4000}, {"query_id": 115, "datasource": "db2_localhost_SAMPLE_polly", "pause_in_seconds": 4000}, {"query_id": 116, "datasource": "db2_localhost_SAMPLE_jason", "pause_in_seconds": 4000}, {"query_id": 117, "datasource": "db2_localhost_SAMPLE_liher", "pause_in_seconds": 4000}, {"query_id": 118, "datasource": "db2_localhost_SAMPLE_polly", "pause_in_seconds": 4000}], "video": "https://ibm.github.io/CyberSkill/?video=monitoringTableManagement.mp4", "author": "polly", "handbook": "/handbooks/monitoringTableManagement.pdf", "outcomes": "Understand how Guardium monitors table management", "description": "This simple story involves monitoring table managment. This story runs in the following flow. 1. Polly creates a table. Sometime later (4 seconds)2. Polly updates the table schema. Sometime later (4 seconds) 3. Polly inserts rows. Sometime later (4 seconds)1. Jason selects from the table. Sometime later (4 seconds)2. Liher deletes data from the table. Sometime later (4 seconds) 3. Polly drops the table"}');
INSERT INTO public.tb_stories (id, runtime, story) VALUES (6, NULL, '{"name": "DB2 Monitoring bad behaviour", "story": [{"query_id": 119, "datasource": "db2_localhost_SAMPLE_liher", "pause_in_seconds": 2000}, {"query_id": 120, "datasource": "db2_localhost_SAMPLE_liher", "pause_in_seconds": 2000}, {"query_id": 121, "datasource": "db2_localhost_SAMPLE_liher", "pause_in_seconds": 2000}, {"query_id": 122, "datasource": "db2_localhost_SAMPLE_liher", "pause_in_seconds": 2000}], "video": "https://ibm.github.io/CyberSkill/?video=monitoringBadBehaviour.mp4", "author": "liher", "handbook": "/handbooks/monitoringBadBehaviour.pdf", "outcomes": "Understand how Guardium monitors table management", "description": "This simple story involves monitoring bad behaviour. This is a short collection of activites that get detected in Guardium."}');
INSERT INTO public.tb_stories (id, runtime, story) VALUES (7, NULL, '{"name": "DB2 Monitoring Sys Admins", "story": [{"query_id": 104, "datasource": "db2_localhost_SAMPLE_polly", "pause_in_seconds": 4000}, {"query_id": 105, "datasource": "db2_localhost_SAMPLE_polly", "pause_in_seconds": 4000}, {"query_id": 106, "datasource": "db2_localhost_SAMPLE_jason", "pause_in_seconds": 4000}, {"query_id": 107, "datasource": "db2_localhost_SAMPLE_liher", "pause_in_seconds": 4000}, {"query_id": 106, "datasource": "db2_localhost_SAMPLE_jason", "pause_in_seconds": 4000}, {"query_id": 108, "datasource": "db2_localhost_SAMPLE_polly", "pause_in_seconds": 4000}, {"query_id": 109, "datasource": "db2_localhost_SAMPLE_polly", "pause_in_seconds": 4000}, {"query_id": 110, "datasource": "db2_localhost_SAMPLE_polly", "pause_in_seconds": 4000}], "video": "https://ibm.github.io/CyberSkill/?video=monitoringSysAdmin.mp4", "author": "polly", "handbook": "/handbooks/monitoringSysAdmin.pdf", "outcomes": "Understand how Guardium monitors system administrators", "description": "This simple story involves the creation and manipulation of a table and its users. Activities such as this show up in the DAM reports of Guardium. This story runs in the following flow. Polly our systems admin creates a schema. Polly then creates a table.  Jason, then selects from that table. Liher, then updates the table. Jason then reselects the same data from the table and sees a new value.  Polly then deletes the user from the table.  Polly then drops the table. Polly then drops the schema."}');

INSERT INTO public.tb_databaseconnections (id, db_connection_id, status, db_type, db_version, db_username, db_password, db_port, db_database, db_url, db_jdbcclassname, db_usericon, db_databaseicon, db_alias, db_access) VALUES (13, 'db2_localhost_SAMPLE_liher', 'active', 'db2', '', 'liher', 'liher', '50000', 'SAMPLE', 'localhost', 'com.ibm.db2.jcc.DB2Driver', '', '', 'DBADM', 'Full Access');
INSERT INTO public.tb_databaseconnections (id, db_connection_id, status, db_type, db_version, db_username, db_password, db_port, db_database, db_url, db_jdbcclassname, db_usericon, db_databaseicon, db_alias, db_access) VALUES (14, 'db2_localhost_SAMPLE_polly', 'active', 'db2', '', 'polly', 'polly', '50000', 'SAMPLE', 'localhost', 'com.ibm.db2.jcc.DB2Driver', '', '', 'DBADM', 'Full Access');
INSERT INTO public.tb_databaseconnections (id, db_connection_id, status, db_type, db_version, db_username, db_password, db_port, db_database, db_url, db_jdbcclassname, db_usericon, db_databaseicon, db_alias, db_access) VALUES (15, 'db2_localhost_SAMPLE_john', 'active', 'db2', '', 'john', 'john', '50000', 'SAMPLE', 'localhost', 'com.ibm.db2.jcc.DB2Driver', '', '', 'Standard User', 'Select,Update,Insert,Delete');
INSERT INTO public.tb_databaseconnections (id, db_connection_id, status, db_type, db_version, db_username, db_password, db_port, db_database, db_url, db_jdbcclassname, db_usericon, db_databaseicon, db_alias, db_access) VALUES (16, 'db2_localhost_SAMPLE_jason', 'active', 'db2', '', 'jason', 'jason', '50000', 'SAMPLE', 'localhost', 'com.ibm.db2.jcc.DB2Driver', '', '', 'Standard User', 'Select,Update,Insert,Delete');
INSERT INTO public.tb_databaseconnections (id, db_connection_id, status, db_type, db_version, db_username, db_password, db_port, db_database, db_url, db_jdbcclassname, db_usericon, db_databaseicon, db_alias, db_access) VALUES (17, 'db2_localhost_SAMPLE_db2inst1', 'active', 'db2', '', 'db2inst1', 'db2inst1', '50000', 'SAMPLE', 'localhost', 'com.ibm.db2.jcc.DB2Driver', '', '', 'DBADM', 'Full Access');

UPDATE public.tb_version SET version = 'v01.0005';

-- 1.0006 changes --

INSERT INTO public.tb_query_types (id, query_type) VALUES (11, 'New Grants');
INSERT INTO public.tb_query_types (id, query_type) VALUES (12, 'Brute-force Attack');

INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (43, 35, 'Policy Violation', 'create+table+if+not+exists+testTable+%28text+varchar%28100%29%2C+id+int%29%3B%0Ainsert+into+testTable+%28text%29+values+%28%27xxx%27%29%3B%0Ainsert+into+testTable+%28text%29+values+%28%27yyy%27%29%3B%0Aselect+*+from+testTable+where+text%3D%27xxx%27+or+15%3D15%3B%0Aselect+*+from+testTable+where+text%3D%27xxx%27+or+%281+and+1+%3D+1%29%3B%0Aselect+text+from+testTable+where+text%3D%27+or+1%3D1+or+%27%27%3D%27%3B%0Aselect+*+from+testTable+where+text%3D%27xxx%27+or+2-1%3D3-2%3B%0Aselect+*+from+testTable+where+text%3D%27xxx%27+or+1%21%3D2%3B%0Aselect+*+from+testTable+where+text%3D%27xxx%27+or+%28%27SQLi%27+%3D+%27SQL%27%2B%27i%27%29%3B%0Aselect+*+from+testTable+where+text%3D%27xxx%27+or+%28%27SQLi%27+%3E+%27S%27%29%3B%0Aselect+*+from+testTable+where+text%3D%27xxx%27+or+%2820+%3E+1%29%3B%0Aselect+*+from+testTable+where+text%3D%27xxx%27+or+%285+between+1+and+10%29%3B%0Aselect+*+from+testTable+where+text%3D%27xxx%27+or+%28%27SQLi%27+%3D+N%27SQLi%27%29%3B%0Aselect+*+from+testTable+where+text%3D%27xxx%27+or+%281+%7C%7C+1+%3D+1%29%3B%0Aselect+*+from+testTable+where+text%3D%27xxx%27+or+%281+%26%26+1+%3D+1%29%3B%0Aselect+*+from+testTable+where+text%3D%27xxx%27+or+2%2F*just+trying+to+be+annoying*%2F%3D2%3B%0A', 'SQL Injection - Tautology', 'mysql', NULL, NULL, 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (44, 35, 'Policy Violation', 'create+table+if+not+exists+testTable+%28text+varchar%28100%29%2C+id+int%29%3B%0Ainsert+into+testTable+%28text%29+values+%28%27xxx%27%29%3B%0Ainsert+into+testTable+%28text%29+values+%28%27yyy%27%29%3B%0Ainsert+into+testTable%28text%29+values%28%27sleep%285%29--%27%29%3B%0Aselect+*+from+testTable+where+text%3D%27sleep%2812%29%23%27%3B%0Aselect+*+from+testTable+where+text%3D%27xxx%27%3B--+sleep%285%29%3B', 'SQL Injection - Side channel', 'mysql', NULL, NULL, 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (45, 35, 'Policy Violation', 'create+table+if+not+exists+testTable+%28text+varchar%28100%29%2C+id+int%29%3B%0Ainsert+into+testTable+%28text%29+values+%28%27xxx%27%29%3B%0Ainsert+into+testTable+%28text%29+values+%28%27yyy%27%29%3B%0Ainsert+into+testTable%28text%29+values%28%27benchmark%28123456%29%27%29%3B%0Aselect+*+from+testTable+where+text%3D%27%29%2C%28select%2520if%28count%28*%29%21%3D-1%2Cbenchmark%283000000%2CMD5%281%29%29%2Cbenchmark%283000000%29%29%29%2F*%27%3B%0Aselect+*+from+testTable+where+text%3D%27%29%2C%28select%2520if%28count%28*%29%21%3D-1%2Cbenchmark%283000000%2CMD5%281%29%29%2Cbenchmark%283000000%2CMD5%281%29%29%29%29%2F*%27%3B%0Aselect+*+from+testTable+where+text%3D%27%29%2C%28select%2520if%28count%28*%29%21%3D-1%2Cbenchmark%283000000%2CMD5%281%29%29%2Cbenchmark%283000000%2CMD5%281%29%29%29%29%2523%27%3B%0A', 'SQL Injection - Denial Of Service', 'mysql', NULL, NULL, 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (46, 35, 'Policy Violation', 'create+table+if+not+exists+testTable+%28text+varchar%28100%29%2C+id+int%29%3B%0Ainsert+into+testTable+%28text%29+values+%28%27xxx%27%29%3B%0Ainsert+into+testTable+%28text%29+values+%28%27yyy%27%29%3B%0Aselect+*+from+testTable+where+text%3D%27%26lt%3B%21--%23exec%2520cmd%3D%26quot%3B%2Fusr%2Fbin%2Fid%3B--%26gt%3B%27%3B%0Aselect+*+from+testTable+where+text%3D%27%26+ping+-n+30+127.0.0.1+%26%27%3B%0Aselect+*+from+testTable+where+text%3D%27%24%3B%2Fusr%2Fbin%2Fid%27%3B%0Aselect+*+from+testTable+where+text%3D%27cat+%2Fetc%2Fpasswd%27%3B%0Aselect+*+from+testTable+where+text%3D%27%3C%3Fphp+system%28%5C%22sleep+10%5C%22%29%3B%3F%3E%27%3B%0Ainsert+into+testTable%28text%2C+id%29+values+%28%27ifconfig%27%2C+333%29%3B%0Ainsert+into+testTable%28text%2C+id%29+values+%28%27ls+-l+%2Fetc%2F%27%2C+444%29%3B%0Aselect+*+from+testTable+where+text%3D%27%7C+netstat+-an%27%3B%0Aselect+*+from+testTable+where+text%3D%27which+python%27%3B%0Aselect+*+from+testTable+where+text%3D%27%26%26+whoami%27%3B%0Aselect+*+from+testTable+where+text%3D%27%7B%7B%5B%5D+.__+Class+__.__+base+__.__+subclasses+__+%28%29%7D%7D%27%3B%0Aselect+*+from+testTable+where+text+like+%27%25_%5B%5E%21_%25%2F%25a%3FF%25_D%29_%28F%25%29_%25%28%5B%29%28%7B%7D%25%29%7B%28%29%7D%C2%A3%24%26N%25_%29%24*%C2%A3%28%29%24*R%5C%22_%29%5D%5B%25%5D%28%25%5Bx%5D%29%25a%5D%5B%24*%5C%22%C2%A3%24-9%5D_%25%27%3B%0Aselect+*+from+testTable+where+text+like+%27%2564_%5B%5E%21_%2565%2F%25aa%3FF%2564_D%29_%28F%2564%29_%2536%28%5B%29%28%7B%7D%2533%29%7B%28%29%7D%C2%A3%24%26N%2555_%29%24*%C2%A3%28%29%24*R%5C%22_%29%5D%5B%2555%5D%28%2566%5Bx%5D%29%25ba%5D%5B%24*%5C%22%C2%A3%24-9%5D_%2554%27%3B%0Aselect+*+from+testTable+where+text+like+%27%25n%5B%5En%5Dy%5B%5Ej%5Dl%5B%5Ek%5Dd%5B%5El%5Dh%5B%5Ez%5Dt%5B%5Ek%5Db%5B%5Eq%5Dt%5B%5Eq%5D%5B%5En%5D%21%25%27%3B%0Aselect+*+from+testTable+where+text+like+%27_%5Br%2Fa%29_+_%28r%2Fb%29_+_%28r-d%29_%27%3B%0Aselect+*+from+testTable+where+text+LIKE+%27%25_%5Baaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%5B%21+-z%5D%40%24%21_%25%27%3B%0Aselect+%2F*%2132302+1%2F0%2C+*%2F+1+from+testTable+where+text%3D%27yyy%27%3B%0Aselect+*+from+testTable+where+text%3D%27%3Fid%3D1%2F*comment*%2Fand%2F**%2F1%3D1%2F**%2F--%27%3B%0Aselect+*+from+testTable+where+text%3D%27xxx%27+union+select+*+from+testTable%3B%0Aselect+%28%40version+-+1%29+from+dual%3B%0A%28select+1+-+%28select+1+-+%28select+1%29%29%29+union+all+select+2+--%3B%0ASELECT+CONCAT%28%270x%27%2CHEX%28%27c%3A%5C%5Cboot.ini%27%29%29%3B%0ASELECT+LOAD_FILE%280x633A5C626F6F742E696E69%29%3B%0ASELECT+ASCII%28%27a%27%29%3B%0Aselect+text%2Cnull+from+testTable+UNION+ALL+SELECT+NULL%2Cversion%28%29--%3B%0Ainsert+into+testTable%28text%29+values%28%27%5E%28%28%5Ba-z%5D%29%2B.%29%2B%5BA-Z%5D%28%5Ba-z%5D%29%2B%24%27%29%3B%0Aselect+*+from+testTable+where+text%3D%27xxx%27%3B', 'OS Command Injection', 'mysql', NULL, NULL, 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (47, 35, 'New Grants', 'CREATE+USER+%27JUMP%27%40%27%25%27+IDENTIFIED+BY+%27guardium%27%3B%0AGRANT+ALL+PRIVILEGES+ON+*.*+TO+%27JUMP%27%40%27%25%27%3B', 'Create Single User JUMP', 'mysql', 'Create User with ALL PRIVILEGES', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (48, 35, 'New Grants', 'GRANT+CREATE+USER%2C+DROP+%2C+GRANT+OPTION+ON+*.*+TO+%27JUMP%27%40%27%25%27%3B', 'Add Create User Privilege To JUMP', 'mysql', '', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (49, 35, 'New Grants', 'REVOKE+CREATE+USER%2C+DROP+%2C+GRANT+OPTION+ON+*.*+FROM+%27JUMP%27%40%27%25%27%3B', 'Revoke Create User Privilege From JUMP', 'mysql', '', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (50, 35, 'New Grants', 'DROP+USER+%27JUMP%27%40%27%25%27%3B', 'Drop Single User JUMP', 'mysql', '', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (51, 35, 'New Grants', 'CREATE+USER+%27MYUSER%7Bi%7D%27%40%27%25%27+IDENTIFIED+BY+%27guardium%27%3B%0AGRANT+ALL+PRIVILEGES+ON+*.*+TO+%27MYUSER%7Bi%7D%27%40%27%25%27%3B', 'Create Multiple Users', 'mysql', '', '', 15);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (52, 35, 'New Grants', 'DROP+USER+%27MYUSER%7Bi%7D%27%40%27%25%27%3B', 'Drop Multiple Users', 'mysql', '', '', 15);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (53, 35, 'New Grants', 'select+*+from+tbl_bugs%3B%0Aselect+*+from+tbl_calls%0Aselect+*+from+tbl_crm_accounts%3B%0Aselect+*+from+tbl_crm_accounts_status%3B%0Aselect+*+from+tbl_email_lists%3B%0Aselect+*+from+tbl_product%3B', 'New SQL Statements', 'mysql', '', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (54, 35, 'New Grants', 'CREATE+USER+%27TMP%27%40%27%25%27+IDENTIFIED+BY+%27guardium%27%3B', 'User created Exceptions', 'mysql', 'Run as USER1', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (55, 35, 'Brute-force Attack', '%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A', 'Many failed attempts by multiple DB users from the same client IP', 'mysql', 'run this case once', '', 15);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (56, 35, 'Brute-force Attack', '%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D%0A%7Bbruteforce%3AMYUSER%7Bi%7D%7D', 'Many failed attempts by multiple DB users outside working hours', 'mysql', 'run this case once, outside working hours', '', 15);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (57, 35, 'Brute-force Attack', '%7Bbruteforce%3AJUMP%7D', 'Failed login attempt by dormant user', 'mysql', 'run this case just once. 
Change username to match a dormant user', '', 15);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (58, 35, 'Brute-force Attack', 'CREATE+USER+%27TMP%27%40%27%25%27+IDENTIFIED+BY+%27guardium%27%3B', 'Failed login attempt followed by insufficient privileges', 'mysql', 'Run this as user USER2', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (59, 35, 'Brute-force Attack', 'select+*+from+tbl_bugs%3B%0Aselect+*+from+tbl_calls%0Aselect+*+from+tbl_crm_accounts%3B%0Aselect+*+from+tbl_crm_accounts_status%3B%0Aselect+*+from+tbl_email_lists%3B%0Aselect+*+from+tbl_product%3B', 'Failed login attempt followed by execution of new SQL statements', 'mysql', 'Run this as user USER2', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (60, 35, 'Brute-force Attack', 'select+*+from+account_groups%3B', 'Failed login attempt followed by access to sensitive data', 'mysql', 'make sure account_groups is in your Sensitive Objects group', '', 1);
INSERT INTO public.tb_query (id, fk_tb_databaseconnections_id, query_db_type, query_string, query_usecase, query_type, query_description, video_link, query_loop) VALUES (61, 35, 'Brute-force Attack', '%7Bbruteforce%3AMYUSER3%7D', 'Failed login attempts from different Source Programs.', 'mysql', 'Also, execute this from bash

for i in {1..15}
do
        echo attempt $i
        mysql -uMYUSER3 -pbadpass crm -e "select * from tbl_fake" > /dev/null 2>&1
done
', '', 15);




UPDATE public.tb_version SET version = 'v01.0006';

-- 1.0007 changes --
CREATE TABLE public.tb_myvars (id SERIAL PRIMARY KEY, username VARCHAR(255) UNIQUE, data JSONB);

INSERT INTO public.tb_myvars (username, data) VALUES ('admin','{"my_var1": 1, "my_var2": "simpleString1"}');
INSERT INTO public.tb_myvars (username, data) VALUES ('username','{"my_var1": 2, "my_var2": "simpleString2"}');

UPDATE public.tb_version SET version = 'v01.0007';




