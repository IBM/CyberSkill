<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PQC Domain Scanner Dashboard</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîê Post-Quantum Cryptography Domain Scanner</h1>
            <p class="subtitle">Monitor domain readiness for quantum-safe cryptography</p>
        </header>

        <!-- Statistics Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üåê</div>
                <div class="stat-content">
                    <h3 id="total-domains">0</h3>
                    <p>Total Domains</p>
                </div>
            </div>
            <div class="stat-card success">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-content">
                    <h3 id="pqc-ready">0</h3>
                    <p>PQC Ready</p>
                </div>
            </div>
            <div class="stat-card danger">
                <div class="stat-icon">‚ö†Ô∏è</div>
                <div class="stat-content">
                    <h3 id="vulnerable">0</h3>
                    <p>Vulnerable</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚ö°</div>
                <div class="stat-content">
                    <h3 id="avg-response">0ms</h3>
                    <p>Avg Response Time</p>
                </div>
            </div>
            <div class="stat-card warning">
                <div class="stat-icon">üéØ</div>
                <div class="stat-content">
                    <h3 id="high-risk">0</h3>
                    <p>High Risk Domains</p>
                </div>
            </div>
        </div>

        <!-- Domain Management -->
        <section class="card">
            <h2>Domain Management</h2>
            <div class="domain-input-group">
                <input type="text" id="domain-input" placeholder="Enter domain (e.g., example.com)" />
                <button onclick="addDomain()" class="btn btn-primary">Add Domain</button>
                <button onclick="scanAllDomains()" class="btn btn-secondary">Scan All</button>
                <button onclick="refreshData()" class="btn btn-secondary">Refresh</button>
                <button onclick="exportReport()" class="btn btn-export">üìä Export Report</button>
            </div>
            <div id="domain-list" class="domain-list"></div>
        </section>

        <!-- Risk Distribution Section -->
        <section class="card">
            <h2>üéØ Risk Distribution Analysis</h2>
            <div class="risk-overview">
                <div class="risk-summary-grid">
                    <div class="risk-summary-card critical">
                        <div class="risk-icon">üî¥</div>
                        <div class="risk-content">
                            <h3 id="critical-count">0</h3>
                            <p>Critical Risk</p>
                            <span class="risk-percentage" id="critical-percent">0%</span>
                        </div>
                    </div>
                    <div class="risk-summary-card high">
                        <div class="risk-icon">üü†</div>
                        <div class="risk-content">
                            <h3 id="high-count">0</h3>
                            <p>High Risk</p>
                            <span class="risk-percentage" id="high-percent">0%</span>
                        </div>
                    </div>
                    <div class="risk-summary-card medium">
                        <div class="risk-icon">üü°</div>
                        <div class="risk-content">
                            <h3 id="medium-count">0</h3>
                            <p>Medium Risk</p>
                            <span class="risk-percentage" id="medium-percent">0%</span>
                        </div>
                    </div>
                    <div class="risk-summary-card low">
                        <div class="risk-icon">üü¢</div>
                        <div class="risk-content">
                            <h3 id="low-count">0</h3>
                            <p>Low Risk</p>
                            <span class="risk-percentage" id="low-percent">0%</span>
                        </div>
                    </div>
                </div>
                <div class="risk-chart-container">
                    <canvas id="riskDistributionChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Trend Analysis Section -->
        <section class="card">
            <h2>üìà Trend Analysis</h2>
            <div class="trend-controls">
                <label>Time Period:</label>
                <select id="trend-period" onchange="loadTrendData()">
                    <option value="7">Last 7 Days</option>
                    <option value="14">Last 14 Days</option>
                    <option value="30" selected>Last 30 Days</option>
                    <option value="60">Last 60 Days</option>
                    <option value="90">Last 90 Days</option>
                </select>
            </div>
            <div class="trend-charts-grid">
                <div class="trend-chart-wrapper">
                    <h3>PQC Adoption Over Time</h3>
                    <canvas id="pqcAdoptionChart"></canvas>
                </div>
                <div class="trend-chart-wrapper">
                    <h3>Average Risk Score Trend</h3>
                    <canvas id="riskTrendChart"></canvas>
                </div>
                <div class="trend-chart-wrapper">
                    <h3>TLS 1.3 Adoption</h3>
                    <canvas id="tlsTrendChart"></canvas>
                </div>
                <div class="trend-chart-wrapper">
                    <h3>Critical/High Risk Domains</h3>
                    <canvas id="criticalTrendChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Charts Section -->
        <div class="charts-grid">
            <section class="card">
                <h2>PQC Readiness Distribution</h2>
                <canvas id="readinessChart"></canvas>
            </section>
            <section class="card">
                <h2>Vulnerability Time Window</h2>
                <canvas id="vulnerabilityChart"></canvas>
            </section>
        </div>

        <!-- Algorithm Distribution -->
        <section class="card">
            <h2>Algorithm Distribution</h2>
            <canvas id="algorithmChart"></canvas>
        </section>

        <!-- Recent Scans Table -->
        <section class="card">
            <h2>Recent Scan Results</h2>
            <div class="table-controls">
                <input type="text" id="search-input" placeholder="Search domains..." onkeyup="filterResults()" />
                <select id="risk-filter" onchange="filterResults()">
                    <option value="">All Risk Levels</option>
                    <option value="CRITICAL">Critical</option>
                    <option value="HIGH">High</option>
                    <option value="MEDIUM">Medium</option>
                    <option value="LOW">Low</option>
                </select>
            </div>
            <div class="table-container">
                <table id="results-table">
                    <thead>
                        <tr>
                            <th>Domain</th>
                            <th>Status</th>
                            <th>Risk Level</th>
                            <th>Risk Score</th>
                            <th>TLS 1.3</th>
                            <th>Algorithm</th>
                            <th>Key Size</th>
                            <th>Days Until Vulnerable</th>
                            <th>Scan Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="results-body">
                        <tr>
                            <td colspan="10" class="loading">Loading data...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Certificate Details Modal -->
        <div id="cert-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeCertModal()">&times;</span>
                <h2>Certificate Details</h2>
                <div id="cert-details"></div>
            </div>
        </div>

        <!-- Certificate Chain Modal -->
        <div id="chain-modal" class="modal">
            <div class="modal-content large">
                <span class="close" onclick="closeChainModal()">&times;</span>
                <h2>üîó Certificate Chain Analysis</h2>
                <div id="chain-details"></div>
            </div>
        </div>

        <!-- Export Modal -->
        <div id="export-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeExportModal()">&times;</span>
                <h2>üìä Export Report</h2>
                <div class="export-options">
                    <h3>Select Export Format:</h3>
                    <div class="export-buttons">
                        <button onclick="exportJSON()" class="btn btn-primary">
                            üìÑ JSON Format
                        </button>
                        <button onclick="exportCSV()" class="btn btn-primary">
                            üìä CSV Format
                        </button>
                        <button onclick="exportHTML()" class="btn btn-primary">
                            üåê HTML Report
                        </button>
                    </div>
                    <h3>Report Options:</h3>
                    <div class="export-checkboxes">
                        <label>
                            <input type="checkbox" id="include-stats" checked>
                            Include Statistics
                        </label>
                        <label>
                            <input type="checkbox" id="include-domains" checked>
                            Include Domain List
                        </label>
                        <label>
                            <input type="checkbox" id="include-scans" checked>
                            Include Scan Results
                        </label>
                        <label>
                            <input type="checkbox" id="include-risks" checked>
                            Include Risk Analysis
                        </label>
                        <label>
                            <input type="checkbox" id="include-trends" checked>
                            Include Trend Data
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p>PQC Domain Scanner v1.0 | Quantum-Safe Cryptography Monitoring</p>
        <p>Integration with <a href="https://github.com/open-quantum-safe/oqs-provider" target="_blank">OQS Provider</a></p>
    </footer>

    <script src="app.js"></script>
</body>
</html>